<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="description" content="">
	<meta name="author" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
	<title>Potree Viewer</title>

	<link rel="stylesheet" type="text/css" href="libs/potree/potree.css">
	<link rel="stylesheet" type="text/css" href="libs/jquery-ui/jquery-ui.min.css">
	<link rel="stylesheet" type="text/css" href="libs/perfect-scrollbar/css/perfect-scrollbar.css">
	<link rel="stylesheet" type="text/css" href="libs/openlayers3/ol.css">
	<link rel="stylesheet" type="text/css" href="libs/spectrum/spectrum.css">
	<link rel="stylesheet" type="text/css" href="libs/jstree/themes/mixed/style.css">
	<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" type="text/css" href="../../../css/main.css">

</head>

<body>
	<script src="libs/jquery/jquery-3.1.1.min.js"></script>
	<script src="libs/spectrum/spectrum.js"></script>
	<script src="libs/perfect-scrollbar/js/perfect-scrollbar.jquery.js"></script>
	<script src="libs/jquery-ui/jquery-ui.min.js"></script>
	<script src="libs/three.js/build/three.min.js"></script>
	<script src="libs/other/BinaryHeap.js"></script>
	<script src="libs/tween/tween.min.js"></script>
	<script src="libs/d3/d3.js"></script>
	<script src="libs/proj4/proj4.js"></script>
	<script src="libs/openlayers3/ol.js"></script>
	<script src="libs/i18next/i18next.js"></script>
	<script src="libs/jstree/jstree.js"></script>
	<script src="libs/potree/potree.js"></script>
	<script src="libs/plasio/js/laslaz.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js"></script>

	<nav class="navbar navbar-expand-lg navbar-light bg-light py-0" style="z-index:100;">

		<!--<div class="container-fluid">-->
		<!-- Brand and toggle get grouped for better mobile display -->
		<a class="navbar-brand" href="#">
			<!--convert the style value to a class and then add the class to the css file.-->
			<img src="../../../img/logo-long.png"  height="10px" class="d-inline-block align-top">
		</a>
		<div class="d-flex justify-content-center nav-item">
			<span class="navbar-text"><h2>Tree by the Survey Monument</h2></span>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse">
			<!--Create class ml-auto for the navbar items you want on the right.-->
			<ul class="navbar-nav ml-auto" >
				<!--a simple top bar link-->
				<li class="nav-item">
					<a class="nav-link" href="#"><i class="fa fa-question-circle fa-lg"></i>&nbsp;&nbsp;<span> Help</span></a>
				</li>
				<!--a top bar link which opens the url in a new page-->
				<li class="nav-item">
					<a class="nav-link" href="#"><i class="fa fa-map fa-lg"></i>&nbsp;&nbsp;<span> Map</span></a>
				</li>
				<!--a drop-down menu-->
				<li class="nav-item dropdown">
					<a class="nav-link dropdown-toggle" href="#" role="button" data-toggle="dropdown" ><i class="fa fa-wrench fa-lg"></i>&nbsp;&nbsp;<span> Tools</span></a>
					<div class="dropdown-menu" >
						<!--use font awesome icons-->
						<a class="dropdown-item" href="#"> <i class="fa fa-facebook-square"></i> Facebook</a>
						<a class="dropdown-item" href="#"> <i class="fa fa-twitter-square"></i> Twitter</a>
						<a class="dropdown-item" href="#"> <i class="fa fa-link"></i> Short Url </a>
					</div>
				</li>

				<!--use icons in the top bar menu-->
				<li>
					<a class="nav-link" href="#"> <i class="fa fa-paint-brush fa-lg"></i>&nbsp;&nbsp;<span> Appearance</span></a>
				</li>
				<!--an about page which open the url in a new page-->
				<li>
					<a class="nav-link" href="#"> <i class="fa fa-info-circle fa-lg"></i>&nbsp;&nbsp;<span> About</span></a>
				</li>
			</ul>
			<nav class="navbar navbar-light bg-light">
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarToggleExternalContent" aria-controls="navbarToggleExternalContent" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
			</nav>
		</div>
	</nav>

	<div class="potree_container" style="position: absolute; width: 100%; height: 100%; left: 0px; top: 0px;" >
		<div id="potree_render_area"></div>
		<div id="potree_sidebar_container"> </div>
		<div id="attribution" ><p class="attr">&nbsp Data acquired and processed by Chase Simpson | Visualization by Richie Slocum &nbsp</p></div>
	</div>
	
	<script>

		window.viewer = new Potree.Viewer(document.getElementById("potree_render_area"));
		
		viewer.setEDLEnabled(true);
		viewer.setFOV(60);
		viewer.setPointBudget(1*1000*1000);
		document.title = "";
		viewer.setEDLEnabled(false);
		viewer.setBackground("gradient"); // ["skybox", "gradient", "black", "white"];
		viewer.setDescription(``);
		viewer.loadSettingsFromURL();
		
		// viewer.loadGUI(() => {
		// 	viewer.setLanguage('en');
		// 	$("#menu_appearance").next().show();
		// 	$("#menu_tools").next().show();
		// 	$("#menu_scene").next().show();
		// 	viewer.toggleSidebar();
		// });
		
		Potree.loadPointCloud("pointclouds/magtree/cloud.js", "magtree", e => {
			let pointcloud = e.pointcloud;
			let material = pointcloud.material;
			viewer.scene.addPointCloud(pointcloud);
			material.pointColorType = Potree.PointColorType.RGB; // any Potree.PointColorType.XXXX 
			material.size = 1;
			material.pointSizeType = Potree.PointSizeType.ADAPTIVE;
			material.shape = Potree.PointShape.SQUARE;
			viewer.fitToScreen();
		});

	</script>
	
	<script>

		var myxyz = {x: 478412, y: 4934781, z: 91};
		// Create Image
        var imagetexture = new THREE.TextureLoader().load( '../../../img/test.jpg' );
        var imageplane = new THREE.PlaneGeometry(4, 3, 1, 1);
        var imagematerial = new THREE.MeshBasicMaterial( {map:imagetexture, side:THREE.DoubleSide});
        var image = new THREE.Mesh(imageplane, imagematerial);

        //Create Pyramid Mesh

        var pyramidgeometry = new THREE.Geometry();

        pyramidgeometry.vertices = [
            new THREE.Vector3( -2, -1.5, 0 ),
            new THREE.Vector3( -2, 1.5, 0 ),
            new THREE.Vector3( 2, 1.5, 0 ),
            new THREE.Vector3( 2, -1.5, 0 ),
            new THREE.Vector3( 0, 0, 4 )
        ];

        pyramidgeometry.faces = [
            new THREE.Face3( 1, 0, 4 ),
            new THREE.Face3( 2, 1, 4 ),
            new THREE.Face3( 3, 2, 4 ),
            new THREE.Face3( 0, 3, 4 )
        ];

        var pyramidmaterial = new THREE.MeshBasicMaterial( {   color: 0xD73F09,
            wireframe: true
            } );


        var pyramid = new THREE.Mesh( pyramidgeometry, pyramidmaterial );

        var imagepyramid  = new THREE.Object3D();

        imagepyramid.add(image);
		imagepyramid.add(pyramid);

        imagepyramid.position.x = myxyz.x;
        imagepyramid.position.y = myxyz.y;
        imagepyramid.position.z = myxyz.z+25;
        imagepyramid.rotation.x = 5*Math.PI/180;
        imagepyramid.rotation.z = 75*Math.PI/180;

        viewer.scene.scene.add(imagepyramid);

        // image.rotation.x = 0;
        // image.position.x = myxyz.x;
        // image.position.y = myxyz.y;
        // image.position.z = myxyz.z;
        //
        // viewer.scene.scene.add(image);
        // Render Loop
        var render = function () {
            requestAnimationFrame( render );

            // image.rotation.x += 0.01;
            // image.rotation.y += 0.02;
            // viewer.scene.view.position.z+=0.1;
            // Render the scene
            //renderer.render(scene, camera);
        };
		function addImageFrustum(imagename, pos) {
		    return 0;
		}
        render();
	</script>


  </body>
</html>
